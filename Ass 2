import Adafruit_DHT
import RPi.GPIO as GPIO
import time

GPIO.setmode(GPIO.BCM)
GPIO.setup(20, GPIO.OUT)  # Temperature LED
GPIO.setup(26, GPIO.OUT)  # Humidity LED
GPIO.setwarnings(False)

print("Starting Temperature & Humidity Monitoring...")
print("Press Ctrl+C to exit\n")

try:
    while True:
        Humid, Temp = Adafruit_DHT.read_retry(11, 21)
        
        if Humid is not None and Temp is not None:
            print(f"Humidity: {Humid:.1f}% | Temperature: {Temp:.1f}°C")
            
            # Humidity check
            if Humid > 65:
                GPIO.output(26, GPIO.HIGH)
                print("⚠️  High Humidity Alert!")
            else:
                GPIO.output(26, GPIO.LOW)
            
            # Temperature check
            if Temp > 28:
                GPIO.output(20, GPIO.HIGH)
                print("⚠️  High Temperature Alert!")
            else:
                GPIO.output(20, GPIO.LOW)
        else:
            print("Failed to read sensor. Retrying...")
        
        time.sleep(2)  # Read every 2 seconds

except KeyboardInterrupt:
    print("\n\nCleaning up GPIO...")
    GPIO.cleanup()
    print("Program terminated.")
